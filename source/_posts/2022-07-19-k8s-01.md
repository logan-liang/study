---
title: kube-apiserver
tags:
  - k8s-核心组件
categories:
  - Kubernetes
comments: true
date: 2022-07-19 17:15:17
---


### 介绍

是k8s最重要的核心组件之一，主要提供以下功能：

* 提供集群管理的REST API接口，包括认证授权、数据校验以及集群状态变更等
* 提供其他模块之间的数据交互和通信的枢纽

### REST API

api server支持同时提供https和http API，其中http API是非安全接口，不做任何认证授权机制，不建议生产环境启用。

在实际使用中，通常通过kubectl来访问apiserver，也可以通过k8s各个语言的client库来访问。

### 访问控制

Kubernetes API的每个请求都会经过多阶段的访问控制之后才会被接受，这包括认证、授权以及准入控制等。

#### 认证

开启TLS时，所有的请求都需要首先认证。K8s支持多种认证机制，并支持同时开启多个认证插件。认证成功，则用户的username会传入授权模块做进一步授权验证；而对于认证失败的请求则返回401。

更多认证模块的使用方法可以参考 Kubernetes 认证插件。

#### 授权

认证之后的请求就到了授权模块。跟认证类似，k8s支持多种授权机制，并支持同时开启多个授权插件。成功则进一步请求验证；对于失败的请求则返回HTTP 403。

更多授权模块的使用方法可以参考 Kubernetes 授权插件。

#### 准入控制

准入控制用来对请求做进一步的验证或添加默认参数。不同于授权和认证只关心请求的用户和操作，准入控制还处理请求的内容，并且仅对创建、更新、删除或连接等有效，而对读操作无效。准入控制也支持同时开启多个插件，只有全部插件都通过的请求才可以放进系统。
更多准入控制模块的使用方法可以参考 Kubernetes 准入控制。


